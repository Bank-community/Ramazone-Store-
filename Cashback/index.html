<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Dukaan Pay</title>
<link rel="manifest" href="manifest.json">

   
    <link rel="apple-touch-icon" href="https://i.ibb.co/0VzN1b3h/20251008-194847.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Third-party scripts for QR scanning and screenshot -->
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- CSS Styles -->
    <style>
        :root {
            --bg-page: #f0f2f5; 
            --bg-card: #ffffff; 
            --text-primary: #1c2028;
            --text-secondary: #5a647e; 
            --border-color: #e8ef3; 
            --brand-red: #e50914;
            --accent-green: #27ae60; 
            --due-red: #ff6b6b;
            --brand-blue: #0052D4; 
            --link-blue: #0056b3;
            --line-color: #ced4da;
            --shadow-light: rgba(0, 0, 0, 0.05);
            --shadow-medium: rgba(0, 0, 0, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { height: 100%; }
        body {
            font-family: 'Poppins', sans-serif; 
            background-color: var(--bg-page);
            min-height: 100%;
        }
        .container { 
            width: 100%; 
            max-width: 100%; 
            margin: 0;
        }
        .view { display: none; background-color: var(--bg-page); min-height: 100vh; }
        #login-view, #registration-view { padding: 20px; background-color: var(--bg-card); }
        #dashboard-view { padding: 0; }
        .view.active { display: block; animation: fadeIn 0.3s ease-in-out; }
        
        #network-view.active, #notification-view.active, #payment-view.active {
            display: flex; width: 100%; max-width: 100%;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* --- Login/Register --- */
        .auth-container { padding: 20px; border-radius: 16px; margin-top: 40px; background-color: var(--bg-card); box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .main-logo { max-width: 200px; margin: 0 auto 30px auto; display: block; }
        h1 { text-align: center; font-size: 22px; font-weight: 600; margin-bottom: 30px; }
        .form-group { margin-bottom: 20px; }
        label { font-weight: 500; color: var(--text-secondary); font-size: 14px; margin-bottom: 8px; display: block; }
        input[type="text"], input[type="tel"], input[type="password"], input[type="number"] {
            width: 100%; padding: 12px; background-color: var(--bg-page); border: 1px solid #ced4da;
            border-radius: 8px; font-size: 16px;
        }
        button { width: 100%; padding: 14px; background: var(--brand-red); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600; }
        button:disabled { background-color: #aaa; cursor: not-allowed; }
        .form-link { text-align: center; margin-top: 25px; color: var(--text-secondary); font-size: 14px; }
        .form-link a { color: var(--brand-red); text-decoration: none; font-weight: 600; }
        .error-message { color: var(--due-red); font-size: 14px; text-align: center; margin-top: 15px; display: none; }
        
        /* --- Dashboard UI --- */
        .header-wrapper {
             background-color: var(--bg-card);
             padding: 0;
             position: sticky;
             top: 0;
             z-index: 100;
             box-shadow: 0 2px 4px var(--shadow-light);
        }
        .header {
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header-left, .header-right { flex: 1; }
        .header-center { flex: 2; text-align: center; }
        .header-logo { height: 30px; }
        .header-right { text-align: right; }
        .header-profile-avatar {
            width: 40px; height: 40px; border-radius: 50%;
            object-fit: cover; border: 2px solid var(--brand-red);
            cursor: pointer;
        }
        #header-notification-btn {
            cursor: pointer;
            color: var(--text-secondary);
        }

        .wallet-card-wrapper {
            margin-bottom: 24px;
        }
        .wallet-card {
            background: linear-gradient(45deg, #0052D4, #4364F7, #6FB1FC);
            color: white; padding: 24px;
            text-align: center;
            border-radius: 0;
        }

        #wallet-user-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }
        .wallet-balance-label { font-size: 14px; color: rgba(255,255,255,0.8); }
        #wallet-balance { font-size: 40px; font-weight: 700; line-height: 1; margin-bottom: 20px; }
        
        /* === WALLET FOOTER (UPDATED) === */
        .wallet-footer { 
            display: grid; 
            grid-template-columns: 1fr auto 1fr; 
            align-items: start; /* Align to start for button */
            border-top: 1px solid rgba(255, 255, 255, 0.2); 
            padding-top: 20px; 
        }
        .wallet-footer-item { text-align: center; }
        .wallet-footer-item p { font-size: 12px; color: rgba(255,255,255,0.8); margin: 0; }
        .wallet-footer-item .amount { font-size: 16px; font-weight: 600; }
        #wallet-share-btn { cursor: pointer; }
        #wallet-share-btn svg { width: 24px; height: 24px; stroke: white; }
        
        /* === PAY DUE BUTTON (UPDATED) === */
        #pay-due-amount-btn {
            background-color: var(--brand-red);
            color: white;
            border: none;
            padding: 6px 16px; /* Adjusted padding */
            font-size: 13px;
            font-weight: 600;
            border-radius: 20px;
            cursor: pointer;
            display: none; /* JS toggles this */
            width: auto;
            /* margin-top: 8px; REMOVED */
        }
        /* === END WALLET FOOTER UPDATE === */

        .actions-section {
            margin-bottom: 24px;
            padding: 0 16px;
        }
        .section-title { font-size: 18px; font-weight: 600; margin-bottom: 16px; }
        .dashboard-actions { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; } 
        .action-card { 
            background-color: var(--bg-card); padding: 15px 10px; text-align: center; cursor: pointer; 
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 12px var(--shadow-light);
            display: flex; flex-direction: column; justify-content: center; align-items: center; aspect-ratio: 1/1;
            position: relative; overflow: hidden;
            border-radius: 4px;
        }
        .action-card:hover { transform: translateY(-4px); box-shadow: 0 6px 16px var(--shadow-medium); }
        .action-card.disabled { background-color: #f8f9fa; cursor: not-allowed; color: #adb5bd; }
        .action-card .icon { margin-bottom: 12px; width: 32px; height: 32px; }
        .action-card .card-text { font-size: 13px; font-weight: 500; color: var(--text-primary); }
        .action-card.disabled .card-text { color: #adb5bd; }
        
        .section { 
            background: var(--bg-card); 
            padding: 24px 16px;
            border-radius: 0;
        }

        #transaction-summary {
            background-color: var(--bg-page); border-radius: 10px; padding: 12px 15px;
            margin-bottom: 15px; display: flex;
            justify-content: space-between; align-items: center;
            border: 1px solid var(--border-color);
        }
        #transaction-summary .summary-label { font-size: 14px; font-weight: 500; color: var(--text-secondary); }
        #transaction-summary .summary-amount { font-size: 18px; font-weight: 700; color: var(--text-primary); }

        .filter-bar { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 10px; }
        .filter-btn { padding: 6px 14px; border: 1px solid #ccc; background: transparent; color: var(--text-secondary); border-radius: 20px; cursor: pointer; font-size: 14px; white-space: nowrap; }
        .filter-btn.active { background-color: var(--brand-red); color: white; border-color: var(--brand-red); }
        .history-list { display: flex; flex-direction: column; gap: 12px; }
        .history-item { 
            display: flex; align-items: center; justify-content: space-between; 
            padding-bottom: 12px; border-bottom: 1px solid var(--border-color);
            cursor: pointer; transition: background-color 0.2s;
        }
        .history-item:hover { background-color: #fafafa; }
        .history-item:last-child { border-bottom: none; }
        .history-info .title { font-weight: 500; font-size: 15px; }
        .history-info .date { font-size: 13px; color: var(--text-secondary); }
        .history-amount .amount.credit { color: var(--accent-green); }
        .history-amount .amount.debit { color: var(--due-red); }
        .history-amount .amount.rejected { color: var(--due-red); }
        .history-amount .status { font-size: 12px; text-transform: capitalize; }

        /* --- Modals --- */
        .modal-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background-color: rgba(0,0,0,0.6); display: none; 
            justify-content: center; align-items: center; z-index: 1000; padding: 15px;
        }
        .modal-overlay.active { display: flex; }
        .modal-content { 
            background-color: var(--bg-card); padding: 25px; border-radius: 16px; 
            width: 100%; max-width: 400px; position: relative;
            animation: fadeInScale 0.3s ease-out;
        }
        @keyframes fadeInScale { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .modal-content h3 { text-align: center; font-size: 20px; margin-bottom: 20px; }
        .modal-actions { display: flex; gap: 10px; margin-top: 20px; }
        .btn-secondary { background: #e8eef3; color: var(--text-primary); }
        #password-verification-modal { z-index: 1001; }
        #profile-modal .modal-content { padding-top: 15px; }
        #modal-profile-img-container { text-align: center; margin-bottom: 15px; position: relative; }
        #modal-profile-img { width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid var(--brand-red); cursor: pointer; transition: transform 0.2s; }
        #modal-profile-img:hover { transform: scale(1.05); }
        #edit-profile-pic-icon { position: absolute; bottom: 0; right: calc(50% - 40px); background-color: var(--text-primary); color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid var(--bg-card); cursor: pointer; }
        #edit-profile-pic-icon svg { width: 14px; height: 14px; }
        #profile-modal #logout-btn { background-color: var(--text-secondary); margin-top: 20px; }
        
        /* OLD SCANNER CSS (MODIFIED) - Ab yeh fullscreen page ke andar use hoga */
        #scanner-container { width: 100%; max-width: 300px; aspect-ratio: 1/1; margin: 0 auto 15px; border-radius: 16px; overflow: hidden; background: #000; }
        #scanner-video { width: 100%; height: 100%; object-fit: cover; }
        
        .professional-modal .modal-content { padding: 30px; max-width: 380px; text-align: center; }
        .professional-modal .success-icon { width: 80px; height: 80px; background-color: var(--accent-green); border-radius: 50%; margin: 0 auto 20px auto; display: flex; align-items: center; justify-content: center; }
        .professional-modal .success-icon svg { width: 40px; height: 40px; stroke: white; stroke-width: 4; }
        .professional-modal h2 { font-size: 24px; font-weight: 700; margin-bottom: 10px; }
        .professional-modal .amount { font-size: 36px; font-weight: 700; color: var(--brand-red); margin-bottom: 25px; }
        .professional-modal .details-box { background-color: var(--bg-page); border-radius: 12px; padding: 15px; text-align: left; margin-bottom: 30px; }
        .professional-modal .detail-item { display: flex; justify-content: space-between; font-size: 14px; margin-bottom: 10px; }
        .professional-modal .detail-item:last-child { margin-bottom: 0; }
        .professional-modal .detail-item .label { color: var(--text-secondary); }
        .professional-modal .detail-item .value { font-weight: 600; }
        .professional-modal .action-btn { width: 100%; }
        
        /* === TRANSACTION DETAILS MODAL (UPDATED CSS) === */
        #transaction-details-modal hr { border: none; height: 1px; background-color: var(--border-color); margin-bottom: 20px; }
        #transaction-details-modal .details-list { display: flex; flex-direction: column; gap: 15px; text-align: left; margin-bottom: 20px; }
        
        /* Status Badge Fix */
        #transaction-details-modal .status-badge { 
            background-color: #e9f7ef; color: var(--accent-green); padding: 4px 12px; border-radius: 15px; font-size: 13px; font-weight: 600;
            display: inline-block; /* Wraps content */
            width: auto; /* Wraps content */
        }
        #transaction-details-modal .status-badge.pending { background-color: #fff4e5; color: #f39c12; }
        #transaction-details-modal .status-badge.rejected { background-color: #ffebee; color: #c0392b; }
        
        #transaction-details-modal .detail-item {
            align-items: center; /* Vertically center align items */
        }
        #transaction-details-modal .detail-item .value {
            text-align: right;
            padding: 0;
            flex-grow: 1;
            word-break: break-all;
        }
        
        /* New Copy Button Style */
        #details-copy-txn-id-icon-btn {
            background: none;
            border: none;
            padding: 0;
            cursor: pointer;
            line-height: 1;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        #details-copy-txn-id-icon-btn:hover {
            opacity: 1;
        }
        #details-copy-txn-id-icon-btn svg {
            width: 16px;
            height: 16px;
        }

        /* Updated Modal Actions */
        #transaction-details-modal .modal-actions {
            display: flex;
            flex-direction: column; /* Stack buttons vertically */
            gap: 10px;
            margin-top: 20px; 
        }
        #transaction-details-modal .action-btn,
        #transaction-details-modal .btn-secondary {
            width: 100%; /* Make buttons full-width */
            flex: none; 
        }
        /* === END UPDATED STYLES === */

        .modal-close-btn { position: absolute; top: 10px; right: 15px; background: transparent; border: none; font-size: 28px; font-weight: bold; cursor: pointer; color: #aaa; line-height: 1; padding: 0; }
        .modal-close-btn:hover { color: #000; }
        .toast-notification { position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%); background-color: var(--text-primary); color: white; padding: 12px 25px; border-radius: 25px; font-size: 15px; z-index: 2000; transition: bottom 0.5s ease; }
        .toast-notification.show { bottom: 30px; }
        
        /* === Fullscreen View & Header (Used by Network, Notifications, Payment) === */
        .fullscreen-view { flex-direction: column; height: 100vh; padding: 0; background-color: var(--bg-page); }
        .fullscreen-header { display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background-color: var(--bg-card); }
        .fullscreen-header h1 { font-size: 18px; font-weight: 600; margin: 0; text-align: center; flex-grow: 1; }
        .fullscreen-header .header-action { display: flex; cursor: pointer; align-items: center; justify-content: center; }
        .fullscreen-header .header-action svg { width: 24px; height: 24px; stroke: var(--text-secondary); }
        
        /* Network View Specific */
        .network-tabs { display: flex; gap: 10px; padding: 15px; flex-shrink: 0; background-color: var(--bg-card); border-bottom: 1px solid var(--border-color);}
        .network-tab-btn { flex: 1; padding: 10px; font-size: 14px; font-weight: 600; border: 1px solid var(--border-color); background-color: var(--bg-card); color: var(--text-secondary); border-radius: 8px; cursor: pointer; transition: all 0.2s ease; }
        .network-tab-btn.active { background-color: var(--brand-red); color: white; border-color: var(--brand-red); }
        .network-content-container { flex-grow: 1; overflow: hidden; position: relative; }
        .network-tab-content { display: none; width: 100%; height: 100%; }
        .network-tab-content.active { display: block; }
        #downline-content { width: 100%; height: 100%; overflow: auto; text-align: center; background-color: #ffffff; }
        .tree-container { position: relative; display: inline-block; padding: 40px; white-space: nowrap; }
        #connector-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; overflow: visible; }
        .tree { display: inline-flex; flex-direction: column; align-items: center; }
        .node-children { display: flex; justify-content: center; padding-top: 80px; position: relative; }
        .node-wrapper { display: flex; flex-direction: column; align-items: center; padding: 0 35px; position: relative; }
        .node { display: flex; flex-direction: column; align-items: center; background-color: white; padding: 15px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08); width: 150px; position: relative; z-index: 2; cursor: pointer; border: 1px solid #e9ecef; transition: transform 0.2s, box-shadow 0.2s; }
        .node:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12); }
        .node-avatar { width: 65px; height: 65px; border-radius: 50%; background-color: var(--brand-red); color: white; display: flex; align-items: center; justify-content: center; font-size: 28px; font-weight: 700; margin-bottom: 10px; overflow: hidden; }
        .node-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .node-name { font-weight: 600; font-size: 16px; }
        .node-earning { font-size: 13px; color: var(--accent-green); }
        .commission-tag { position: absolute; background-color: var(--text-secondary); color: white; padding: 3px 8px; font-size: 12px; border-radius: 5px; font-weight: 600; z-index: 3; transform: translate(-50%, -50%); }
        #upline-list { display: flex; flex-direction: column; align-items: center; padding: 40px; gap: 25px; }
        .upline-member { display: flex; flex-direction: column; align-items: center; position: relative; }
        .upline-member .node { width: 160px; }
        .upline-member.current-user .node { border: 2px solid var(--brand-blue); }
        .upline-member:not(:last-child)::after { content: ''; width: 2px; height: 25px; background-color: var(--line-color); position: absolute; top: -25px; left: 50%; transform: translateX(-50%); }
        .upline-commission { position: absolute; top: -12px; left: calc(50% + 20px); font-size: 13px; color: var(--text-secondary); font-weight: 600; background-color: var(--bg-page); padding: 0 5px; }
        #network-loader, .empty-state { text-align: center; padding: 40px; color: var(--text-secondary); }
        
        /* Notification View Specific */
        #notification-center-list { flex-grow: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 15px; }
        .notification-center-item { padding: 20px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .notification-center-item.due-notification-item { background-color: #fff5f5; border: 1px solid var(--due-red); }
        .notification-center-item .title { font-size: 16px; font-weight: 600; line-height: 1.4; word-break: break-all; }
        .notification-center-item .title a { color: var(--link-blue) !important; text-decoration: underline; }
        .notification-center-item .percentage { font-size: 40px; font-weight: 800; margin-top: 10px; }
        .notification-center-item .paragraph { font-size: 14px; color: inherit; opacity: 0.9; margin-top: 15px; line-height: 1.6; white-space: pre-wrap; }
        
        /* Popup Notification (Dashboard) */
        #popup-notification { position: fixed; top: -200px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 450px; padding: 15px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); z-index: 9999; display: flex; align-items: center; justify-content: space-between; transition: top 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        #popup-notification.show { top: 20px; }
        .popup-notification-content { display: flex; align-items: center; gap: 15px; }
        .popup-notification-icon { font-size: 28px; font-weight: 800; }
        .popup-notification-text .title { font-size: 14px; font-weight: 600; line-height: 1.3; }
        .popup-notification-text .percentage { font-size: 16px; font-weight: 600; margin-top: 2px; }
        #popup-notification-close { background: none; border: none; font-size: 24px; cursor: pointer; opacity: 0.7; padding: 0; line-height: 1; }
        
        /* Due Payment QR Modal styles */
        #due-qr-code { margin: 15px auto; display: flex; justify-content: center; align-items: center; }
        #due-qr-code canvas, #due-qr-code img { border-radius: 8px; }
        .qr-instructions { font-size: 13px; color: var(--text-secondary); margin-top: 15px; line-height: 1.5; }
        
        /* ========================================
        === NEW RMZ Pay Fullscreen Page Styles ===
        ========================================
        */
        #payment-view {
            background-color: var(--bg-card); /* White background */
        }
        #payment-content-container {
            flex-grow: 1;
            overflow-y: auto;
            /* Bottom padding equal to nav height */
            padding: 20px 20px 100px 20px; 
            background-color: var(--bg-card);
        }
        
        /* Payment page content views */
        .payment-view { 
            display: none; /* JS se handle hoga */
            flex-direction: column;
            width: 100%;
        }
        .payment-view.active { 
            display: flex; /* 'flex' use karein */
            animation: fadeIn 0.2s; 
        }
        
        /* New Upload QR Button */
        #upload-qr-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            padding: 12px;
            background: var(--bg-page);
            color: var(--text-primary);
            border: 1px solid #ced4da;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
        }
        #upload-qr-btn svg {
            width: 22px;
            height: 22px;
            fill: var(--text-secondary);
        }
        #scanner-status { 
            text-align:center; 
            margin-top:15px; 
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        /* P2P Search Button */
        #p2p-search-btn {
            width: auto;
            padding: 0 20px;
            background-color: var(--brand-red);
            color: white;
            border: none;
        }
        #p2p-receiver-info {
            text-align: center; 
            margin: 20px 0; 
            display: none;
            font-size: 16px;
            color: var(--text-primary);
        }
        
        /* Recent Payments Section */
        .recent-payments-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--bg-page);
        }
        #recent-payments-container {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 15px;
            /* Hide scrollbar */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none;  /* IE/Edge */
        }
        #recent-payments-container::-webkit-scrollbar {
            display: none; /* Chrome/Safari */
        }
        .recent-user-chip {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            min-width: 70px;
            text-align: center;
        }
        .recent-user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--brand-red);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 600;
            overflow: hidden;
            border: 2px solid var(--bg-page);
        }
        .recent-user-avatar img {
            width: 100%; height: 100%; object-fit: cover;
        }
        .recent-user-name {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
        }
        
        /* RMZ Store View */
        #rmz-store-pay-view p {
            text-align:center; 
            font-size: 16px; 
            margin-bottom: 20px;
        }

        /* Submit Buttons */
        #p2p-pay-submit-btn, #rmz-pay-submit-btn {
            margin-top: 15px;
        }
        
        /* New Bottom Navigation Bar */
        #payment-bottom-nav {
            display: flex;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 75px; /* Thodi height badhayi */
            background-color: var(--bg-card);
            border-top: 1px solid #e0e0e0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            z-index: 100;
        }
        .payment-nav-btn {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px 0;
            font-family: 'Poppins', sans-serif;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            transition: color 0.2s;
        }
        .payment-nav-btn svg {
            width: 24px;
            height: 24px;
            fill: var(--text-secondary);
            transition: fill 0.2s;
            margin-bottom: 2px;
        }
        .payment-nav-btn.active {
            color: var(--brand-red);
        }
        .payment-nav-btn.active svg {
            fill: var(--brand-red);
        }

        /* Payment Processing Modal Styles */
        #payment-processing-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        #payment-processing-modal.active {
            display: flex;
        }
        .payment-processing-content {
            background-color: white;
            padding: 30px;
            border-radius: 16px;
            text-align: center;
            max-width: 350px;
            width: 90%;
        }
        .payment-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top-color: var(--brand-red);
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .payment-processing-text {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .payment-processing-subtext {
            font-size: 14px;
            color: var(--text-secondary);
        }

        #install-pwa-btn {
            width: 100%;
            padding: 12px;
            background: var(--accent-green);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: background-color 0.3s;
        }
        #install-pwa-btn:hover {
            background-color: #2ecc71;
        }
        
        /* ====== (NEW) My QR Code Modal Styles ====== */
        #my-qr-code-modal .modal-content {
            text-align: center;
        }
        #my-qr-code-card {
            background-color: white; 
            padding: 20px; 
            border-radius: 12px; 
            border: 1px solid #eee; 
            display: inline-block; 
            margin: 10px 0 20px 0;
        }
        #my-qr-code-container {
             margin: 0 auto; 
             display: flex; 
             justify-content: center; 
             align-items: center;
             padding: 10px;
             background: white;
             border-radius: 8px;
             width: 220px; /* QR Code size + padding */
             height: 220px;
        }
        #my-qr-code-container canvas, 
        #my-qr-code-container img {
            border-radius: 8px;
        }
        #my-qr-payment-id {
            font-weight: 600; 
            margin-top: 15px; 
            color: var(--text-primary);
            font-size: 16px;
            word-break: break-all;
        }
        #download-my-qr-btn {
            width: 100%;
            background-color: var(--brand-red);
        }

    </style>
</head>
<body>

    <div class="container">
        <!-- Login View -->
        <div id="login-view" class="view">
            <!-- ... (Login HTML waisa hi hai) ... -->
             <div class="auth-container">
                <img src="https://i.ibb.co/S4S28p24/20251106-092435.png" alt="Ramazone Logo" class="main-logo">
                <h1>Customer Login</h1>
                <form id="login-form">
                    <div class="form-group"><label for="login-mobile">Mobile Number</label><input type="tel" id="login-mobile" required></div>
                    <div class="form-group"><label for="login-password">Password</label><input type="password" id="login-password" required></div>
                    <button type="submit">Login</button><p id="login-error-msg" class="error-message"></p>
                </form>
                <p class="form-link">Naye user? <a href="#" id="show-register-link">Yahan register karein</a></p>
            </div>
        </div>

        <!-- Registration View -->
        <div id="registration-view" class="view">
            <!-- ... (Registration HTML waisa hi hai) ... -->
            <div class="auth-container">
                 <img src="https://i.ibb.co/S4S28p24/20251106-092435.png" alt="Ramazone Logo" class="main-logo">
                 <h1>Register New Account</h1>
                <form id="register-form">
                    <div class="form-group"><label for="reg-name">Poora Naam</label><input type="text" id="reg-name" required></div>
                    <div class="form-group"><label for="reg-mobile">Mobile Number</label><input type="tel" id="reg-mobile" required></div>
                    <div class="form-group"><label for="reg-password">Password</label><input type="password" id="reg-password" required></div>
                    <button type="submit">Register Karein</button><p id="register-error-msg" class="error-message"></p>
                </form>
                <p class="form-link">Pehle se account hai? <a href="#" id="show-login-link">Yahan login karein</a></p>
            </div>
        </div>

        <!-- Dashboard View -->
        <div id="dashboard-view" class="view active">
            <!-- ... (Dashboard HTML waisa hi hai) ... -->
            <div class="header-wrapper">
                 <header class="header">
                    <div class="header-left">
                        <svg id="header-notification-btn" xmlns="http://www.w3.org/2000/svg" height="28px" viewBox="0 0 24 24" width="28px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2 2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/></svg>
                    </div>
                    <div class="header-center">
                        <a href="https://ramazone.in" target="_blank">
                            <img src="https://i.ibb.co/S4S28p24/20251106-092435.png" alt="Ramazone" class="header-logo">
                        </a>
                    </div>
                    <div class="header-right">
                        <img id="header-profile-avatar" src="https://placehold.co/40x40/e50914/FFFFFF?text=R" alt="Profile" class="header-profile-avatar">
                    </div>
                </header>
            </div>
            
            <main>
                <section class="wallet-card-wrapper">
                    <div class="wallet-card">
                        <h3 id="wallet-user-name">User Name</h3>
                        <p class="wallet-balance-label">Available Balance</p>
                        <p id="wallet-balance">â‚¹ 0.00</p>
                        
                        <!-- === WALLET FOOTER (UPDATED for Pay Now centering) === -->
                        <div class="wallet-footer">
                            <!-- Item 1: Due Amount -->
                            <div class="wallet-footer-item">
                                <p>Due Amount</p>
                                <span id="due-amount" class="amount" style="color: var(--due-red);">â‚¹0.00</span>
                            </div>
                            
                            <!-- Item 2: Center Column (Share & Pay Now) -->
                            <div class="wallet-footer-item" style="display: flex; flex-direction: column; align-items: center; justify-content: start; gap: 15px;">
                                <div id="wallet-share-btn" title="Share App">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
                                </div>
                                <!-- Pay Now Button (Moved to Center) -->
                                <button id="pay-due-amount-btn">Pay Now</button>
                            </div>

                            <!-- Item 3: Total Credit -->
                            <div class="wallet-footer-item">
                                <p>Total Credit</p>
                                <span id="credit-limit" class="amount">â‚¹0.00</span>
                            </div>
                        </div>
                        <!-- === END WALLET FOOTER UPDATE === -->

                    </div>
                </section>
                
                <button id="install-pwa-btn" style="display: none; margin: 0 16px 24px 16px; width: calc(100% - 32px);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></polyline></svg>
                    <span>Install Dukaan Pay App</span>
                </button>

                <section class="actions-section">
    <h2 class="section-title">Quick Actions</h2>
    <div class="dashboard-actions">

        <a href="https://www.ramazone.in" id="shop-now-btn" class="action-card">
            <img class="icon" src="https://www.svgrepo.com/show/533042/cart-plus.svg" onerror="this.src='https://placehold.co/32x32/ff6b6b/FFFFFF?text=ðŸ›’'">
            <span class="card-text">Shop Now</span>
        </a>

        <div id="scan-and-pay-btn" class="action-card">
            <img class="icon" src="https://www.svgrepo.com/show/503562/scan-qrcode.svg">
            <span class="card-text">RMZ Pay</span>
        </div>

        <div id="whatsapp-support-btn" class="action-card">
            <img class="icon" src="https://www.svgrepo.com/show/452133/whatsapp.svg">
            <span class="card-text">Support</span>
        </div>

    </div>
</section>

                <div class="section">
                    <h2 class="section-title">All Transactions</h2>
                    <div id="transaction-summary" style="display: flex;">
                        <span class="summary-label" id="summary-filter-label">Total Amount (All)</span>
                        <span class="summary-amount" id="summary-total-amount">â‚¹0.00</span>
                    </div>
                    <div class="filter-bar" id="filter-bar">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="payment">Payments</button>
                        <button class="filter-btn" data-filter="due_payment">Due Paid</button>
                        <button class="filter-btn" data-filter="credit_given">Credit</button>
                    </div>
                    <div id="unified-history-list" class="history-list"></div>
                </div>
            </main>
        </div>
        
        <!-- Network View (Hidden but functional) -->
        <div id="network-view" class="view fullscreen-view">
            <!-- ... (Network HTML waisa hi hai) ... -->
            <div class="fullscreen-header"><div id="network-nav-btn" class="header-action" title="Back"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></div><h1 id="network-title">My Network</h1><div id="network-refresh-btn" class="header-action" title="Refresh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg></div></div>
            <div class="network-tabs"><button class="network-tab-btn active" data-tab="downline">My Team</button><button class="network-tab-btn" data-tab="upline">My Sponsor</button></div>
            <div class="network-content-container"><div id="downline-content" class="network-tab-content active"><div class="tree-container"><svg id="connector-svg"></svg><div id="tree-root"></div><div id="commission-tags-container"></div></div></div><div id="upline-content" class="network-tab-content"><div id="upline-list"></div></div></div>
            <div id="network-loader" class="empty-state" style="display:none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">Loading...</div>
        </div>

        <!-- Notification View -->
        <div id="notification-view" class="view fullscreen-view">
           <!-- ... (Notification HTML waisa hi hai) ... -->
           <div class="fullscreen-header"><div id="notification-back-btn" class="header-action" title="Back to Dashboard"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></div><h1>Notifications</h1><div class="header-action" style="width: 24px;"></div></div>
           <div id="notification-center-list"></div>
        </div>

        <!-- 
        ========================================
        === NEW: RMZ Pay Fullscreen Page ===
        ========================================
        -->
        <div id="payment-view" class="view fullscreen-view">
            <!-- 1. Header -->
            <div class="fullscreen-header">
                <div id="payment-back-btn" class="header-action" title="Back">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </div>
                <h1>RMZ Pay</h1>
                <div class="header-action" style="width: 24px;"></div> <!-- Dummy div for centering title -->
            </div>

            <!-- 2. Content Area (Swappable) -->
            <div id="payment-content-container">
                
                <!-- 
                  =======================================================
                  === UPDATE: SCAN QR VIEW (Ab P2P bhi isi mein hai) ===
                  =======================================================
                -->
                <div id="scan-qr-view" class="payment-view active">
                    <!-- 2.1.1: Scanner Section -->
                    <div id="scanner-container">
                        <video id="scanner-video" playsinline></video>
                    </div>
                    <input type="file" id="qr-file-input" accept="image/*" style="display: none;">
                    <button id="upload-qr-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M16 4.00098H8C5.79086 4.00098 4 5.79184 4 8.00098V16.001C4 18.2101 5.79086 20.001 8 20.001H16C18.2091 20.001 20 18.2101 20 16.001V8.00098C20 5.79184 18.2091 4.00098 16 4.00098ZM16 18.001H8C6.89543 18.001 6 17.1055 6 16.001V8.00098C6 6.89641 6.89543 6.00098 8 6.00098H16C17.1046 6.00098 18 6.89641 18 8.00098V16.001C18 17.1055 17.1046 18.001 16 18.001ZM15 11.001C15 12.6579 13.6569 14.001 12 14.001C10.3431 14.001 9 12.6579 9 11.001C9 9.3441 10.3431 8.00098 12 8.00098C13.6569 8.00098 15 9.3441 15 11.001Z" fill="currentColor"></path></svg>
                        <span>Upload QR Image</span>
                    </button>
                    <p id="scanner-status">Scanning for QR code...</p>

                    <hr style="border: none; height: 1px; background-color: #eee; margin: 25px 0;">

                    <!-- 
                      2.1.2: P2P (Pay to User) Section 
                      (Yahan move kar diya gaya hai)
                    -->
                    
                    <!-- Recent Payments -->
                    <h3 class="recent-payments-title">Recent Payments</h3>
                    <div id="recent-payments-container">
                        <!-- JS will fill this. -->
                    </div>
                    
                    <!-- Search Form -->
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="p2p-search-id">Enter Receiver's Payment ID</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="p2p-search-id" placeholder="e.g. 98765@RMZ" style="flex-grow: 1;">
                            <button id="p2p-search-btn">Search</button>
                        </div>
                    </div>
                    
                    <div id="p2p-receiver-info">
                        <!-- JS will fill this -->
                    </div>
                    
                    <div id="p2p-payment-form" style="display: none;">
                        <div class="form-group">
                            <label for="p2p-payment-amount">Amount (â‚¹)</label>
                            <input type="number" id="p2p-payment-amount" min="1" required>
                        </div>
                        <p id="p2p-payment-error-msg" class="error-message"></p>
                        <button id="p2p-pay-submit-btn" class="btn-primary">Pay Now</button>
                    </div>
                </div>
                <!-- === END UPDATED SCAN QR VIEW === -->
                

                <!-- 
                  2.2. Pay to User (P2P) View 
                  (REMOVED - Iska content upar 'scan-qr-view' mein chala gaya hai)
                -->
                <!-- <div id="p2p-pay-view" class="payment-view"> ... </div> -->


                <!-- 2.3. RMZ Store Payment View -->
                <div id="rmz-store-pay-view" class="payment-view">
                    <p>Paying to: <strong>Ramazone Store</strong></p>
                    <div class="form-group">
                        <label for="rmz-payment-amount">Amount (â‚¹)</label>
                        <input type="number" id="rmz-payment-amount" min="5" required>
                    </div>
                    <p id="rmz-payment-error-msg" class="error-message"></p>
                    <button id="rmz-pay-submit-btn" class="btn-primary">Pay Now</button>
                </div>
            </div>

            <!-- 
              =====================================
              === UPDATE: Bottom Navigation Bar ===
              =====================================
            -->
            <div id="payment-bottom-nav">
                <!-- Button 1: Scan QR (Ab isme P2P bhi hai) -->
                <button id="payment-nav-scan" class="payment-nav-btn active">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M15 3H21V9H19V5H15V3ZM9 3H3V9H5V5H9V3ZM15 21H21V15H19V19H15V21ZM9 21H3V15H5V19H9V21ZM5 11H7V13H5V11ZM7 11H9V13H7V11ZM9 11H11V13H9V11ZM11 11H13V13H11V11ZM13 11H15V13H13V11ZM15 11H17V13H15V11ZM17 11H19V13H17V11Z" fill="currentColor"></path></svg>
                    <span>Scan & Pay User</span>
                </button>
                
                <!-- Button 2: Pay to User (REMOVED) -->
                <!-- 
                <button id="payment-nav-p2p" class="payment-nav-btn">
                    ...
                </button> 
                -->
                
                <!-- Button 3: RMZ Payment -->
                <button id="payment-nav-rmz" class="payment-nav-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M21 4H3C1.89543 4 1 4.89543 1 6V18C1 19.1046 1.89543 20 3 20H21C22.1046 20 23 19.1046 23 18V6C23 4.89543 22.1046 4 21 4ZM3 6H21V8H3V6ZM21 18H3V10H21V18ZM5 12V14H11V12H5Z" fill="currentColor"></path></svg>
                    <span>RMZ Payment</span>
                </button>
            </div>
        </div>
        <!-- === END RMZ PAY PAGE === -->

    </div>
        
    <!-- 
      ================================
      === MODALS (REMOVED SCAN MODAL) ===
      ================================
    -->

    <!-- (REMOVED) Scan and Pay Modal -->
    <!-- <div id="scan-pay-modal" class="modal-overlay"> ... </div> -->
    

    <!-- Password Verification Modal (Same) -->
    <div id="password-verification-modal" class="modal-overlay">
        <div class="modal-content"> 
            <h3>Verify Your Identity</h3>
            <p style="text-align:center; font-size: 14px; color: var(--text-secondary); margin-bottom: 15px;">Please enter your password to continue.</p>
            <div class="form-group">
                <label for="verification-password">Password</label>
                <input type="password" id="verification-password" required>
            </div>
            <p id="verification-error-msg" class="error-message"></p>
            <div class="modal-actions">
                <button type="button" class="btn-secondary" data-close-modal>Cancel</button>
                <button id="verification-confirm-btn" class="btn-primary">Confirm</button>
            </div>
        </div>
    </div>
    
    <!-- 
      ================================
      === UPDATE: Profile Modal ===
      ================================
    -->
    <div id="profile-modal" class="modal-overlay">
        <div class="modal-content">
            <div id="modal-profile-img-container">
                <img id="modal-profile-img" src="https://placehold.co/80x80/e50914/FFFFFF?text=R" alt="Profile Picture">
                <div id="edit-profile-pic-icon" title="Change Profile Picture">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                </div>
            </div>
            <h3>My Profile</h3>
            
            <!-- === Payment ID with Copy Button (UPDATED) === -->
            <div id="profile-payment-id-container">
                <p style="font-size: 12px; text-align: center; color: var(--text-secondary);">Your Payment ID</p>
                <!-- (NEW) Wrapper div to hold both icons -->
                <div style="display: flex; align-items: center; justify-content: center; gap: 10px; background-color: var(--bg-page); padding: 8px 12px; border-radius: 8px; margin-top: 5px;">
                    <span id="profile-payment-id" style="font-weight:600; font-size: 15px; color: var(--text-primary);"></span>
                    
                    <!-- Button 1: Copy ID -->
                    <button id="profile-copy-id-btn" title="Copy ID" style="background:none; border:none; cursor:pointer; padding:0; line-height: 1; color: var(--text-secondary);">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                    
                    <!-- (NEW) Button 2: Show My QR -->
                    <button id="profile-show-qr-btn" title="Show My QR Code" style="background:none; border:none; cursor:pointer; padding:0; line-height: 1; color: var(--text-secondary);">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15 3H21V9H19V5H15V3ZM9 3H3V9H5V5H9V3ZM15 21H21V15H19V19H15V21ZM9 21H3V15H5V19H9V21ZM3 11H5V13H3V11ZM5 11H7V13H5V11ZM7 11H9V13H7V11ZM9 11H11V13H9V11ZM11 11H13V13H11V11ZM13 11H15V13H13V11ZM15 11H17V13H15V11ZM17 11H19V13H17V11ZM19 11H21V13H19V11ZM11 3H13V5H11V3ZM11 19H13V21H11V19ZM3 19H5V21H3V19ZM3 15H5V17H3V15ZM19 19H21V21H19V19ZM19 15H21V17H19V15ZM19 3H21V5H19V3Z"/></svg>
                    </button>
                </div>
            </div>
            <!-- === END Payment ID Update === -->

            <form id="password-change-form" style="margin-top: 20px;">
                <div class="form-group">
                    <label for="current-password">Purana Password</label>
                    <input type="password" id="current-password" required>
                </div>
                <div class="form-group">
                    <label for="new-password">Naya Password</label>
                    <input type="password" id="new-password" required>
                </div>
                <button type="submit" id="password-change-btn">Password Badlein</button>
                <p id="password-change-error-msg" class="error-message"></p>
            </form>
            <button id="logout-btn" style="width:100%; margin-top: 15px;" class="btn-secondary">Logout</button>
            <div class="modal-actions" style="margin-top:10px;">
                <button type="button" class="btn-secondary" data-close-modal>Close</button>
            </div>
        </div>
    </div>
    <!-- === END Profile Modal === -->
    
    
    <!-- Full Profile Picture Modal (Same) -->
    <div id="profile-picture-modal" class="modal-overlay">
        <div class="modal-content" style="padding: 10px; background-color: transparent; text-align: center; box-shadow: none; width: auto;">
            <button class="modal-close-btn" data-close-modal style="color: white; font-size: 36px; top: 0px; right: 5px; text-shadow: 0 1px 3px black;">&times;</button>
            <img id="full-profile-img" src="" alt="Profile Picture" style="max-width: 90vw; max-height: 80vh; border-radius: 16px;">
        </div>
    </div>
    
    <!-- Payment Success Modal (Same) -->
    <div id="payment-success-modal" class="modal-overlay professional-modal">
        <div class="modal-content">
            <div class="success-icon">
                <svg viewBox="0 0 52 52" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14 27.2L21.84 35L38 19" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <h2>Payment Successful!</h2>
            <p class="amount" id="success-modal-amount"></p>
            <div class="details-box">
                <div class="detail-item">
                    <span class="label">Paid to</span>
                    <span class="value" id="success-modal-receiver"></span>
                </div>
                <div class="detail-item">
                    <span class="label">Transaction ID</span>
                    <span class="value" id="success-modal-txn-id"></span>
                </div>
                <div class="detail-item">
                    <span class="label">Date & Time</span>
                    <span class="value" id="success-modal-datetime"></span>
                </div>
            </div>
            
            <!-- === UPDATED Modal Actions === -->
            <div class="modal-actions" style="flex-direction: column; gap: 10px;">
                 <button id="success-download-receipt-btn" class="action-btn btn-secondary">Download Receipt</button>
                 <button class="action-btn" data-close-modal style="background-color: var(--brand-red); color: white;">Done</button>
            </div>
            <!-- === END Updated Modal Actions === -->
        </div>
    </div>
    
    <!-- Payment Failure Modal (Same) -->
    <div id="payment-failure-modal" class="modal-overlay professional-modal">
        <div class="modal-content">
            <div class="success-icon" style="background-color: var(--due-red);">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
            </div>
            <h2 style="color: var(--due-red);">Transaction Failed</h2>
            <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 25px;">
                We could not complete your payment. Please check your network and try again.
            </p>
            <button class="action-btn" data-close-modal style="background-color: var(--text-secondary); color: white;">Close</button>
        </div>
    </div>

    <!-- Payment Processing Modal (Same) -->
    <div id="payment-processing-modal">
        <div class="payment-processing-content">
            <div class="payment-spinner"></div>
            <div class="payment-processing-text">Processing Payment</div>
            <div class="payment-processing-subtext">Please wait while we process your payment...</div>
        </div>
    </div>

    <!-- Transaction Details Modal (Same) -->
    <div id="transaction-details-modal" class="modal-overlay professional-modal">
        <div class="modal-content">
            <p class="amount" id="details-modal-amount"></p>
            <hr>
            <div class="details-list">
                <div class="detail-item">
                    <span class="label">Status</span>
                    <span class="value status-badge" id="details-modal-status"></span>
                </div>
                <div class="detail-item">
                    <span class="label">Description</span>
                    <span class="value" id="details-modal-desc"></span>
                </div>
                <div class="detail-item">
                    <span class="label">Date</span>
                    <span class="value" id="details-modal-date"></span>
                </div>
                <div class="detail-item">
                    <span class="label">Time</span>
                    <span class="value" id="details-modal-time"></span>
                </div>
                
                <!-- === New Transaction ID Row === -->
                <div class="detail-item">
                    <span class="label">Transaction ID</span>
                    <span class="value" id="details-modal-txn-id-val" style="display: flex; align-items: center; gap: 8px; justify-content: flex-end;">
                        <span id="details-modal-txn-id-text" style="font-weight: 600; font-size: 13px;"></span>
                        <button id="details-copy-txn-id-icon-btn" title="Copy ID">
                            <svg width="16px" height="16px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 9.5V6.5C20 5.09562 20 4.39341 19.782 3.8733C19.5903 3.41449 19.2438 3.06798 18.785 2.87627C18.2649 2.65827 17.5627 2.65827 16.1582 2.65827H12.8418C11.4373 2.65827 10.7351 2.65827 10.215 2.87627C9.75617 3.06798 9.40966 3.41449 9.21796 3.8733C9 4.39341 9 5.09562 9 6.5V9.5M20 9.5V17.5C20 18.9044 20 19.6066 19.782 20.1267C19.5903 20.5855 19.2438 20.932 18.785 21.1237C18.2649 21.3417 17.5627 21.3417 16.1582 21.3417H12.8418C11.4373 21.3417 10.7351 21.3417 10.215 21.1237C9.75617 20.932 9.40966 20.5855 9.21796 20.1267C9 19.6066 9 18.9044 9 17.5V9.5M20 9.5H9M15 6.5V6C15 5.06812 15 4.60218 14.782 4.23463C14.5903 3.91039 14.2696 3.66699 13.9017 3.5233C13.4846 3.35711 13.0044 3.34199 12.0439 3.31175L11.9561 3.30872C10.9956 3.27848 10.5154 3.26336 10.0983 3.42955C9.73038 3.57322 9.40966 3.81662 9.21796 4.14086C9 4.50831 9 4.97425 9 5.90613V6.5M15 6.5H9M15 6.5H16.1582C17.5627 6.5 18.2649 6.5 18.785 6.71799C19.2438 6.90971 19.5903 7.25621 19.782 7.71502C20 8.23513 20 8.93734 20 10.3418V10.5M4 14.5V17.5C4 18.9044 4 19.6066 4.21796 20.1267C4.40966 20.5855 4.75617 20.932 5.215 21.1237C5.73513 21.3417 6.43734 21.3417 7.84177 21.3417H11.1582C12.5627 21.3417 13.2649 21.3417 13.785 21.1237C14.2438 20.932 14.5903 20.5855 14.782 20.1267C15 19.6066 15 18.9044 15 17.5V14.5C15 13.0956 15 12.3934 14.782 11.8733C14.5903 11.4145 14.2438 11.068 13.785 10.8763C13.2649 10.6583 12.5627 10.6583 11.1582 10.6583H7.84177C6.43734 10.6583 5.73513 10.6583 5.215 10.8763C4.75617 11.068 4.40966 11.4145 4.21796 11.8733C4 12.3934 4 13.0956 4 14.5Z" stroke="#5a647e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </button>
                    </span>
                </div>
                <!-- === END New Transaction ID Row === -->

            </div>
            
            <!-- === UPDATED Modal Actions === -->
            <div class="modal-actions">
                <button id="details-pay-again-btn" class="action-btn" style="background-color: var(--brand-red); display: none;">Pay Again</button>
                <button id="details-download-receipt-btn" class="btn-secondary">Download</button>
                <button class="action-btn btn-secondary" data-close-modal>Close</button>
            </div>
            <!-- === END Modal Actions === -->
        </div>
    </div>
    <!-- === END TRANSACTION DETAILS MODAL === -->


    <!-- Due Payment Modal (Same) -->
    <div id="due-payment-modal" class="modal-overlay">
        <div class="modal-content" style="text-align: center;">
            <button class="modal-close-btn" data-close-modal>&times;</button>
            <h3>Pay Your Due Amount</h3>
            <div id="due-qr-card" style="background-color: white; padding: 20px; border-radius: 12px; border: 1px solid #eee; display: inline-block; margin: 20px 0;">
                <img src="https://i.ibb.co/S4S28p24/20251106-092435.png" alt="Ramazone Logo" style="width: 150px; margin: 0 auto 15px auto; display: block;">
                <div id="due-qr-code"></div>
                <p id="due-qr-amount" style="font-size: 24px; font-weight: 700; color: var(--brand-red); margin-top: 10px;"></p>
                <p id="due-qr-upi-id" style="font-weight: 600; margin-top: 5px; color: var(--text-primary);"></p>
                <p style="font-size: 12px; color: var(--text-secondary); margin-top: 10px;">Scan using any UPI app</p>
            </div>
            <p class="qr-instructions">
                Payment karne ke baad, kripya transaction ka screenshot
                <br>
                hamare WhatsApp number par bhejkar confirm karein.
            </p>
            <div class="modal-actions">
                <button id="download-qr-btn" class="btn-secondary">Download QR</button>
            </div>
        </div>
    </div>

    <!-- ====== (NEW) My QR Code Modal ====== -->
    <div id="my-qr-code-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" data-close-modal>&times;</button>
            <h3>My Payment QR Code</h3>
            
            <!-- Card element jise download kiya jayega -->
            <div id="my-qr-code-card">
                <div id="my-qr-code-container">
                    <!-- QR code yahan generate hoga -->
                </div>
                <p id="my-qr-payment-id">Your-ID@RMZ</p>
            </div>
            <!-- End card element -->
            
            <div class="modal-actions" style="margin-top: 0;">
                <button id="download-my-qr-btn" class="btn-primary">Download QR</button>
            </div>
        </div>
    </div>
    <!-- ====== END My QR Code Modal ====== -->


    <!-- Toast and Popup Notifications (Same) -->
    <div id="toast-notification" class="toast-notification"></div>
    <div id="popup-notification">
        <div class="popup-notification-content">
            <div class="popup-notification-icon">ðŸ”¥</div>
            <div class="popup-notification-text">
                <div class="title" id="popup-notification-title"></div>
                <div class="percentage" id="popup-notification-percentage"></div>
            </div>
        </div>
        <button id="popup-notification-close">&times;</button>
    </div>
    <input type="file" id="profile-picture-input" accept="image/*" style="display: none;">
    
    <!-- 
      =================================================
      === JAVASCRIPT FILES (UPDATED) ===
      =================================================
    -->
    <script type="module" src="app.js"></script>
    <script type="module" src="payments.js"></script>

    <!-- Service Worker ke liye inline script -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js').then(function(registration) {
                    console.log('Service Worker registered with scope:', registration.scope);
                }, function(err) {
                    console.log('Service Worker registration failed:', err);
                });
            });
        }
    </script>


</body>
</html>

